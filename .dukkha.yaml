tools:
  golang:
  - name: local
  - name: in-docker
    cmd@template: |-
      - docker run -it --rm
      - -v go-path:/go
      - --workdir $(pwd)
      - -v ${DUKKHA_WORKING_DIR}:${DUKKHA_WORKING_DIR}
      - ghcr.io/arhat-dev/builder-go:{{ .Env.MATRIX_OS }}-{{ .Env.MATRIX_ARCH }}
      - go

  buildah:
  - name: local
  - name: in-docker
    cmd:
    - |-
      docker run -it --rm \
        --workdir $(pwd) \
        -v $(pwd):$(pwd) \
        --security-opt label=disable \
        --security-opt seccomp=unconfined \
        -v buildah-litekube:/var/lib/containers \
        --device /dev/fuse:rw \
        quay.io/buildah/stable \
        buildah
  docker:
  - name: local
    env:
    - DOCKER_BUILDKIT=1

shells:
- name: bash
